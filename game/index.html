<!DOCTYPE html>

<html lang="de">
    <head>
        <meta charset="UTF-8">
        <title>Spiel</title>
    </head>
<body>

<h3>Spiel Einstellungen:</h3>

<form id="roundForm">
    <label>
        <input type="checkbox" name="cbAbsolutMode">
        Deterministischer Modus
    </label>

    <h3>Wähle deine Waffe:</h3>
    <input list="waffen" name="waffe">

    <datalist id="waffen">
        <option value="Faust">
        <option value="Dolch">
        <option value="Schwert">
        <option value="Laserschwert">
        <option value="Magie">
    </datalist>

    <h3>Wähle deine Verteidigungsrichtung:</h3>
    <input list="blockrichtung" name="blockrichtung_input">
    <input type="hidden" name="blockrichtung_id" id="blockrichtung_id">

    <datalist id="blockrichtung">
        <option id="0" value="Oben">
        <option id="1" value="Unten">
        <option id="2" value="Mitte">
    </datalist>

    <h3>Wähle deine Angriffsrichtung:</h3>
    <input list="angriff" name="angriffsrichtung_input">
    <input type="hidden" name="angriffsrichtung_id" id="angriffsrichtung_id">

    <datalist id="angriff">
        <option id="0" value="Oben">
        <option id="1" value="Unten">
        <option id="2" value="Mitte">
    </datalist>

    <br><br>
    <button type="submit">Runde starten</button>
</form>

<p id="output"></p>

<script>
document.getElementById("roundForm").addEventListener("submit", async function(e){
    e.preventDefault();

    const formData = new FormData(this);

    let response = await fetch("logic/Runden.php", {
        method: "POST",
        body: formData
    });

    let data = await response.json();
    document.getElementById("output").innerHTML = data.error || data.text;
});

document.getElementById("blockrichtung_input").addEventListener("change", async function(e) {
    e.preventDefault();
    const elist = document.getElementById("blockrichtung").options;

    for (let opt of elist) {
        if (opt.value === this.value) {
            document.getElementById("blockrichtung_id").value = opt.id;
            break;
        }
    }
});

document.getElementById("angriffsrichtung_input").addEventListener("change", async function(e) {
    e.preventDefault();
    const elist = document.getElementById("Angriffsrichtung").options;

    for (let opt of elist) {
        if (opt.value === this.value) {
            document.getElementById("angriffsrichtung_id").value = opt.id;
            break;
        }
    }
});

</script>

</body>

</html>

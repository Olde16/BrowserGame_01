<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Spiel</title>
</head>
<body>

<h3>Spiel Einstellungen:</h3>

<form id="roundForm">
    <label>
        <input type="checkbox" name="cbAbsolutMode">
        Deterministischer Modus
    </label>

    <h3>W채hle deine Waffe:</h3>
    <input list="waffen" id="waffe">

    <datalist id="waffen">
        <option id="0" value="Faust">
        <option id="1" value="Dolch">
        <option id="2" value="Schwert">
        <option id="3" value="Laserschwert">
        <option id="4" value="Magie">
    </datalist>

    <h3>W채hle deine Verteidigungsrichtung:</h3>
    <input list="blockrichtung" id="block">

    <datalist id="blockrichtung">
        <option id="0" value="Oben">
        <option id="1" value="Unten">
        <option id="2" value="Mitte">
    </datalist>

    <h3>W채hle deine Angriffsrichtung:</h3>
    <input list="angriffrichtung" id="angriff">

    <datalist id="angriffrichtung">
        <option id="0" value="Oben">
        <option id="1" value="Unten">
        <option id="2" value="Mitte">
    </datalist>

    <br><br>
    <button type="submit">Runde starten</button>
</form>

<p id="output"></p>

<script>
document.getElementById("roundForm").addEventListener("submit", async function(e){
    e.preventDefault();

    const formData = new FormData(this);

    let response = await fetch("logic/Runden.php", {
        method: "POST",
        body: formData
    });

    let text = await response.text(); // <-- raw (DEBUG)
    console.log("Server response:", text);

    try {
        let data = JSON.parse(text);
        document.getElementById("output").innerHTML = data.error || data.text;
    } catch(e) {
        document.getElementById("output").innerHTML = "Fehler: Ung체ltige Serverantwort.";
    }
});
</script>

</body>
</html>
